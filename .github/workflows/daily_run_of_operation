
name: æ¯æ—¥æ•°æ®æ¸…æ´—

# â° è§¦å‘æœºåˆ¶ï¼šè¿™é‡Œè®¾å®šçš„æ˜¯å®šæ—¶è¿è¡Œ
on:
  schedule:
    # è¿™é‡Œçš„æ ¼å¼æ˜¯ Cron è¡¨è¾¾å¼ (åˆ† æ—¶ æ—¥ æœˆ å‘¨)
    # æ³¨æ„ï¼šGitHub ä½¿ç”¨çš„æ˜¯ UTC æ—¶é—´ï¼Œæ¯”åŒ—äº¬æ—¶é—´æ…¢ 8 å°æ—¶
    # æ¯”å¦‚ï¼šUTC 00:00 = åŒ—äº¬æ—¶é—´ 08:00
    - cron: '0 0 * * *'  # æ¯å¤©åŒ—äº¬æ—¶é—´æ—©ä¸Š 8 ç‚¹è¿è¡Œ
  
  # å…è®¸ä½ æ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®è§¦å‘ï¼ˆæ–¹ä¾¿æµ‹è¯•ï¼‰
  workflow_dispatch:

# ğŸ” æƒé™è®¾ç½®ï¼šå…è®¸ä»£ç ä¿®æ”¹ä»“åº“å†…å®¹ï¼ˆä¸ºäº†ä¿å­˜ç”Ÿæˆçš„ Excelï¼‰
permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1. æŠŠä»“åº“ä»£ç æ‹‰å–ä¸‹æ¥
      - name: Checkout code
        uses: actions/checkout@v3

      # 2. å®‰è£… Python ç¯å¢ƒ
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # 3. å®‰è£…ä¾èµ–åº“ (pandas, openpyxl)
      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      # 4. è¿è¡Œä½ çš„æ¸…æ´—è„šæœ¬
      - name: Run cleaning script
        run: python script.py

      # 5. æŠŠç”Ÿæˆçš„ Excel æäº¤å›ä»“åº“
      - name: Commit and Push results
        run: |
          git config --global user.name "GitHub Action Bot"
          git config --global user.email "actions@github.com"
          git add clean_data*.xlsx
          # å¦‚æœæœ‰æ–°æ–‡ä»¶å°±æäº¤ï¼Œæ²¡æœ‰å°±ä¸æŠ¥é”™
          git commit -m "è‡ªåŠ¨æ›´æ–°ï¼šæ•°æ®æ¸…æ´—ç»“æœ" || echo "No changes to commit"
          git push
